-- WARNING! 
-- createdb.sql is generated automatically from createdb.ml.in 
-- Do not edit manually!

--
-- PostgreSQL database dump
--

SET client_encoding = 'LATIN9';
SET standard_conforming_strings = off;
SET check_function_bodies = false;
SET client_min_messages = warning;
SET escape_string_warning = off;

SET search_path = public, pg_catalog;

SET default_tablespace = '';

SET default_with_oids = false;

--
-- Name: forums; Type: TABLE; Schema: public; Owner: %%USER%%; Tablespace: 
--

CREATE TABLE forums (
    id serial NOT NULL,
    title text DEFAULT ''::text NOT NULL,
    descr text DEFAULT ''::text NOT NULL,
    moderated boolean DEFAULT false NOT NULL,
    arborescent boolean NOT NULL,
    reader integer NOT NULL,
    writer integer NOT NULL,
    moderator integer NOT NULL
);


ALTER TABLE public.forums OWNER TO %%USER%%;

--
-- Name: messages; Type: TABLE; Schema: public; Owner: %%USER%%; Tablespace: 
--

CREATE TABLE messages (
    id serial NOT NULL,
    datetime timestamp without time zone DEFAULT (now())::timestamp without time zone NOT NULL,
    thr_id integer NOT NULL,
    txt_id integer NOT NULL,
    hidden boolean DEFAULT false NOT NULL,
    parent_id integer DEFAULT 0 NOT NULL,
    sticky boolean DEFAULT false NOT NULL,
    tree_min integer DEFAULT 0 NOT NULL,
    tree_max integer DEFAULT 0 NOT NULL,
    author_id integer NOT NULL
);


ALTER TABLE public.messages OWNER TO %%USER%%;

--
-- Name: COLUMN messages.thr_id; Type: COMMENT; Schema: public; Owner: %%USER%%
--

COMMENT ON COLUMN messages.thr_id IS 'thread';


--
-- Name: COLUMN messages.txt_id; Type: COMMENT; Schema: public; Owner: %%USER%%
--

COMMENT ON COLUMN messages.txt_id IS 'text';


--
-- Name: COLUMN messages.hidden; Type: COMMENT; Schema: public; Owner: %%USER%%
--

COMMENT ON COLUMN messages.hidden IS 'for moderated forums';


-- PAS FINI
-- --
-- -- Name: service_parameters; Type: TABLE; Schema: public; Owner: %%USER%%; Tablespace: 
-- --

-- CREATE TABLE service_parameters (
--     id serial NOT NULL,
--     service_id integer NOT NULL,
--     name text NOT NULL
-- );


-- ALTER TABLE public.service_parameters OWNER TO %%USER%%;

-- --
-- -- Name: services; Type: TABLE; Schema: public; Owner: %%USER%%; Tablespace: 
-- --

-- CREATE TABLE services (
--     id serial NOT NULL,
--     url text NOT NULL
-- );


-- ALTER TABLE public.services OWNER TO %%USER%%;

--
-- Name: tablefunc_crosstab_2; Type: TYPE; Schema: public; Owner: %%USER%%
--

CREATE TYPE tablefunc_crosstab_2 AS (
	row_name text,
	category_1 text,
	category_2 text
);


ALTER TYPE public.tablefunc_crosstab_2 OWNER TO %%USER%%;

--
-- Name: tablefunc_crosstab_3; Type: TYPE; Schema: public; Owner: %%USER%%
--

CREATE TYPE tablefunc_crosstab_3 AS (
	row_name text,
	category_1 text,
	category_2 text,
	category_3 text
);


ALTER TYPE public.tablefunc_crosstab_3 OWNER TO %%USER%%;

--
-- Name: tablefunc_crosstab_4; Type: TYPE; Schema: public; Owner: %%USER%%
--

CREATE TYPE tablefunc_crosstab_4 AS (
	row_name text,
	category_1 text,
	category_2 text,
	category_3 text,
	category_4 text
);


ALTER TYPE public.tablefunc_crosstab_4 OWNER TO %%USER%%;

--
-- Name: textdata; Type: TABLE; Schema: public; Owner: %%USER%%; Tablespace: 
--

CREATE TABLE textdata (
    id serial NOT NULL,
    txt text DEFAULT ''::text NOT NULL
);


ALTER TABLE public.textdata OWNER TO %%USER%%;

--
-- Name: threads; Type: TABLE; Schema: public; Owner: %%USER%%; Tablespace: 
--

CREATE TABLE threads (
    id serial NOT NULL,
    subject text DEFAULT ''::text NOT NULL,
    frm_id integer NOT NULL,
    hidden boolean DEFAULT false NOT NULL,
    datetime timestamp without time zone DEFAULT now() NOT NULL,
    article_id integer,
    author_id integer NOT NULL
);


ALTER TABLE public.threads OWNER TO %%USER%%;

--
-- Name: COLUMN threads.frm_id; Type: COMMENT; Schema: public; Owner: %%USER%%
--

COMMENT ON COLUMN threads.frm_id IS 'forum';


--
-- Name: users; Type: TABLE; Schema: public; Owner: %%USER%%; Tablespace: 
--

CREATE TABLE users (
    id serial NOT NULL,
    login text NOT NULL,
    password text,
    fullname text NOT NULL,
    email text NOT NULL,
    permissions bytea
);


ALTER TABLE public.users OWNER TO %%USER%%;

--
-- Name: wikipages; Type: TABLE; Schema: public; Owner: %%USER%%; Tablespace: 
--

CREATE TABLE wikiboxes (
    id serial NOT NULL,
    wiki_id integer NOT NULL, -- There may be several wikis
    version serial NOT NULL,
    comment text DEFAULT ''::text NOT NULL,
    author text DEFAULT ''::text NOT NULL,
    content text NOT NULL,
    datetime timestamp without time zone DEFAULT now() NOT NULL,
    PRIMARY KEY (id, version)
);


ALTER TABLE public.wikiboxes OWNER TO %%USER%%;

CREATE TABLE wikipages (
    id integer NOT NULL REFERENCES wikiboxes(id),
    pagename text DEFAULT ''::text NOT NULL,
    UNIQUE (pagename),
    UNIQUE (id)
);

ALTER TABLE public.wikipages OWNER TO %%USER%%;

--
-- Name: COLUMN wikiboxes.wik_id; Type: COMMENT; Schema: public; Owner: %%USER%%
--

COMMENT ON COLUMN wikiboxes.wiki_id IS 'wiki';

--
-- Name: wikis; Type: TABLE; Schema: public; Owner: %%USER%%; Tablespace: 
--

CREATE TABLE wikis (
    id serial NOT NULL,
    title text DEFAULT ''::text NOT NULL,
    descr text DEFAULT ''::text NOT NULL
);


ALTER TABLE public.wikis OWNER TO %%USER%%;

-- --
-- -- Name: forums_id_seq; Type: SEQUENCE; Schema: public; Owner: %%USER%%
-- --

-- CREATE SEQUENCE forums_id_seq
--     START WITH 1
--     INCREMENT BY 1
--     NO MAXVALUE
--     NO MINVALUE
--     CACHE 1;


-- ALTER TABLE public.forums_id_seq OWNER TO %%USER%%;

-- --
-- -- Name: forums_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: %%USER%%
-- --

-- ALTER SEQUENCE forums_id_seq OWNED BY forums.id;


-- --
-- -- Name: forums_id_seq; Type: SEQUENCE SET; Schema: public; Owner: %%USER%%
-- --

-- SELECT pg_catalog.setval('forums_id_seq', 1, false);


-- --
-- -- Name: messages_id_seq; Type: SEQUENCE; Schema: public; Owner: %%USER%%
-- --

-- CREATE SEQUENCE messages_id_seq
--     START WITH 1
--     INCREMENT BY 1
--     NO MAXVALUE
--     NO MINVALUE
--     CACHE 1;


-- ALTER TABLE public.messages_id_seq OWNER TO %%USER%%;

-- --
-- -- Name: messages_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: %%USER%%
-- --

-- ALTER SEQUENCE messages_id_seq OWNED BY messages.id;


-- --
-- -- Name: messages_id_seq; Type: SEQUENCE SET; Schema: public; Owner: %%USER%%
-- --

-- SELECT pg_catalog.setval('messages_id_seq', 1, false);


-- --
-- -- Name: service_parameters_id_seq; Type: SEQUENCE; Schema: public; Owner: %%USER%%
-- --

-- CREATE SEQUENCE service_parameters_id_seq
--     START WITH 1
--     INCREMENT BY 1
--     NO MAXVALUE
--     NO MINVALUE
--     CACHE 1;


-- ALTER TABLE public.service_parameters_id_seq OWNER TO %%USER%%;

-- --
-- -- Name: service_parameters_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: %%USER%%
-- --

-- ALTER SEQUENCE service_parameters_id_seq OWNED BY service_parameters.id;


-- --
-- -- Name: service_parameters_id_seq; Type: SEQUENCE SET; Schema: public; Owner: %%USER%%
-- --

-- SELECT pg_catalog.setval('service_parameters_id_seq', 1, false);


-- --
-- -- Name: services_id_seq; Type: SEQUENCE; Schema: public; Owner: %%USER%%
-- --

-- CREATE SEQUENCE services_id_seq
--     START WITH 1
--     INCREMENT BY 1
--     NO MAXVALUE
--     NO MINVALUE
--     CACHE 1;


-- ALTER TABLE public.services_id_seq OWNER TO %%USER%%;

-- --
-- -- Name: services_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: %%USER%%
-- --

-- ALTER SEQUENCE services_id_seq OWNED BY services.id;


-- --
-- -- Name: services_id_seq; Type: SEQUENCE SET; Schema: public; Owner: %%USER%%
-- --

-- SELECT pg_catalog.setval('services_id_seq', 1, false);


--
-- Name: textdata_id_seq; Type: SEQUENCE; Schema: public; Owner: %%USER%%
--

-- CREATE SEQUENCE textdata_id_seq
--     START WITH 1
--     INCREMENT BY 1
--     NO MAXVALUE
--     NO MINVALUE
--     CACHE 1;


-- ALTER TABLE public.textdata_id_seq OWNER TO %%USER%%;

-- --
-- -- Name: textdata_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: %%USER%%
-- --

-- ALTER SEQUENCE textdata_id_seq OWNED BY textdata.id;


-- --
-- -- Name: textdata_id_seq; Type: SEQUENCE SET; Schema: public; Owner: %%USER%%
-- --

-- SELECT pg_catalog.setval('textdata_id_seq', 1, false);


-- --
-- -- Name: threads_id_seq; Type: SEQUENCE; Schema: public; Owner: %%USER%%
-- --

-- CREATE SEQUENCE threads_id_seq
--     START WITH 1
--     INCREMENT BY 1
--     NO MAXVALUE
--     NO MINVALUE
--     CACHE 1;


-- ALTER TABLE public.threads_id_seq OWNER TO %%USER%%;

-- --
-- -- Name: threads_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: %%USER%%
-- --

-- ALTER SEQUENCE threads_id_seq OWNED BY threads.id;


-- --
-- -- Name: threads_id_seq; Type: SEQUENCE SET; Schema: public; Owner: %%USER%%
-- --

-- SELECT pg_catalog.setval('threads_id_seq', 1, false);


-- --
-- -- Name: users_id_seq; Type: SEQUENCE; Schema: public; Owner: %%USER%%
-- --

-- CREATE SEQUENCE users_id_seq
--     START WITH 1
--     INCREMENT BY 1
--     NO MAXVALUE
--     NO MINVALUE
--     CACHE 1;


-- ALTER TABLE public.users_id_seq OWNER TO %%USER%%;

-- --
-- -- Name: users_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: %%USER%%
-- --

-- ALTER SEQUENCE users_id_seq OWNED BY users.id;


-- --
-- -- Name: users_id_seq; Type: SEQUENCE SET; Schema: public; Owner: %%USER%%
-- --

-- SELECT pg_catalog.setval('users_id_seq', 1, false);


-- --
-- -- Name: wikipages_id_seq; Type: SEQUENCE; Schema: public; Owner: %%USER%%
-- --

-- CREATE SEQUENCE wikipages_id_seq
--     START WITH 1
--     INCREMENT BY 1
--     NO MAXVALUE
--     NO MINVALUE
--     CACHE 1;


-- ALTER TABLE public.wikipages_id_seq OWNER TO %%USER%%;

-- --
-- -- Name: wikipages_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: %%USER%%
-- --

-- ALTER SEQUENCE wikipages_id_seq OWNED BY wikipages.id;


-- --
-- -- Name: wikipages_id_seq; Type: SEQUENCE SET; Schema: public; Owner: %%USER%%
-- --

-- SELECT pg_catalog.setval('wikipages_id_seq', 1, false);


-- --
-- -- Name: wikis_id_seq; Type: SEQUENCE; Schema: public; Owner: %%USER%%
-- --

-- CREATE SEQUENCE wikis_id_seq
--     START WITH 1
--     INCREMENT BY 1
--     NO MAXVALUE
--     NO MINVALUE
--     CACHE 1;


-- ALTER TABLE public.wikis_id_seq OWNER TO %%USER%%;

-- --
-- -- Name: wikis_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: %%USER%%
-- --

-- ALTER SEQUENCE wikis_id_seq OWNED BY wikis.id;


-- --
-- -- Name: wikis_id_seq; Type: SEQUENCE SET; Schema: public; Owner: %%USER%%
-- --

-- SELECT pg_catalog.setval('wikis_id_seq', 1, false);


-- --
-- -- Name: id; Type: DEFAULT; Schema: public; Owner: %%USER%%
-- --

-- ALTER TABLE forums ALTER COLUMN id SET DEFAULT nextval('forums_id_seq'::regclass);


-- --
-- -- Name: id; Type: DEFAULT; Schema: public; Owner: %%USER%%
-- --

-- ALTER TABLE messages ALTER COLUMN id SET DEFAULT nextval('messages_id_seq'::regclass);


-- --
-- -- Name: id; Type: DEFAULT; Schema: public; Owner: %%USER%%
-- --

-- ALTER TABLE service_parameters ALTER COLUMN id SET DEFAULT nextval('service_parameters_id_seq'::regclass);


-- --
-- -- Name: id; Type: DEFAULT; Schema: public; Owner: %%USER%%
-- --

-- ALTER TABLE services ALTER COLUMN id SET DEFAULT nextval('services_id_seq'::regclass);


-- --
-- -- Name: id; Type: DEFAULT; Schema: public; Owner: %%USER%%
-- --

-- ALTER TABLE textdata ALTER COLUMN id SET DEFAULT nextval('textdata_id_seq'::regclass);


-- --
-- -- Name: id; Type: DEFAULT; Schema: public; Owner: %%USER%%
-- --

-- ALTER TABLE threads ALTER COLUMN id SET DEFAULT nextval('threads_id_seq'::regclass);


-- --
-- -- Name: id; Type: DEFAULT; Schema: public; Owner: %%USER%%
-- --

-- ALTER TABLE users ALTER COLUMN id SET DEFAULT nextval('users_id_seq'::regclass);


-- --
-- -- Name: id; Type: DEFAULT; Schema: public; Owner: %%USER%%
-- --

-- ALTER TABLE wikipages ALTER COLUMN id SET DEFAULT nextval('wikipages_id_seq'::regclass);


-- --
-- -- Name: id; Type: DEFAULT; Schema: public; Owner: %%USER%%
-- --

-- ALTER TABLE wikis ALTER COLUMN id SET DEFAULT nextval('wikis_id_seq'::regclass);


--
-- Data for Name: forums; Type: TABLE DATA; Schema: public; Owner: %%USER%%
--

COPY forums (id, title, descr, moderated, arborescent, reader, writer, moderator) FROM stdin;
\.


--
-- Data for Name: messages; Type: TABLE DATA; Schema: public; Owner: %%USER%%
--

COPY messages (id, datetime, thr_id, txt_id, hidden, parent_id, sticky, tree_min, tree_max, author_id) FROM stdin;
\.


-- --
-- -- Data for Name: service_parameters; Type: TABLE DATA; Schema: public; Owner: %%USER%%
-- --

-- COPY service_parameters (id, service_id, name) FROM stdin;
-- \.


-- --
-- -- Data for Name: services; Type: TABLE DATA; Schema: public; Owner: %%USER%%
-- --

-- COPY services (id, url) FROM stdin;
-- \.


--
-- Data for Name: textdata; Type: TABLE DATA; Schema: public; Owner: %%USER%%
--

COPY textdata (id, txt) FROM stdin;
\.


--
-- Data for Name: threads; Type: TABLE DATA; Schema: public; Owner: %%USER%%
--

COPY threads (id, subject, frm_id, hidden, datetime, article_id, author_id) FROM stdin;
\.


--
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: %%USER%%
--

COPY users (id, login, password, fullname, email, permissions) FROM stdin;
0	anonymous	\N	Anonymous		\N
\.


--
-- Data for Name: wikipages; Type: TABLE DATA; Schema: public; Owner: %%USER%%
--

-- COPY wikipages (id, suffix, wik_id, txt_id, author, datetime, subject) FROM stdin;
-- \.


--
-- Data for Name: wikis; Type: TABLE DATA; Schema: public; Owner: %%USER%%
--

COPY wikis (id, title, descr) FROM stdin;
\.


--
-- Name: forums_pkey; Type: CONSTRAINT; Schema: public; Owner: %%USER%%; Tablespace: 
--

ALTER TABLE ONLY forums
    ADD CONSTRAINT forums_pkey PRIMARY KEY (id);


--
-- Name: messages_pkey; Type: CONSTRAINT; Schema: public; Owner: %%USER%%; Tablespace: 
--

ALTER TABLE ONLY messages
    ADD CONSTRAINT messages_pkey PRIMARY KEY (id);


-- --
-- -- Name: service_parameters_pkey; Type: CONSTRAINT; Schema: public; Owner: %%USER%%; Tablespace: 
-- --

-- ALTER TABLE ONLY service_parameters
--     ADD CONSTRAINT service_parameters_pkey PRIMARY KEY (id);


-- --
-- -- Name: services_pkey; Type: CONSTRAINT; Schema: public; Owner: %%USER%%; Tablespace: 
-- --

-- ALTER TABLE ONLY services
--     ADD CONSTRAINT services_pkey PRIMARY KEY (id);


--
-- Name: textdata_pkey; Type: CONSTRAINT; Schema: public; Owner: %%USER%%; Tablespace: 
--

ALTER TABLE ONLY textdata
    ADD CONSTRAINT textdata_pkey PRIMARY KEY (id);


--
-- Name: threads_pkey; Type: CONSTRAINT; Schema: public; Owner: %%USER%%; Tablespace: 
--

ALTER TABLE ONLY threads
    ADD CONSTRAINT threads_pkey PRIMARY KEY (id);


--
-- Name: users_pkey; Type: CONSTRAINT; Schema: public; Owner: %%USER%%; Tablespace: 
--

ALTER TABLE ONLY users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- Name: wikis_pkey; Type: CONSTRAINT; Schema: public; Owner: %%USER%%; Tablespace: 
--

ALTER TABLE ONLY wikis
    ADD CONSTRAINT wikis_pkey PRIMARY KEY (id);


--
-- Name: forums_moderator_fkey; Type: FK CONSTRAINT; Schema: public; Owner: %%USER%%
--

ALTER TABLE ONLY forums
    ADD CONSTRAINT forums_moderator_fkey FOREIGN KEY (moderator) REFERENCES users(id);


--
-- Name: forums_reader_fkey; Type: FK CONSTRAINT; Schema: public; Owner: %%USER%%
--

ALTER TABLE ONLY forums
    ADD CONSTRAINT forums_reader_fkey FOREIGN KEY (reader) REFERENCES users(id);


--
-- Name: forums_writer_fkey; Type: FK CONSTRAINT; Schema: public; Owner: %%USER%%
--

ALTER TABLE ONLY forums
    ADD CONSTRAINT forums_writer_fkey FOREIGN KEY (writer) REFERENCES users(id);


--
-- Name: messages_author_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: %%USER%%
--

ALTER TABLE ONLY messages
    ADD CONSTRAINT messages_author_id_fkey FOREIGN KEY (author_id) REFERENCES users(id);


--
-- Name: messages_thr_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: %%USER%%
--

ALTER TABLE ONLY messages
    ADD CONSTRAINT messages_thr_id_fkey FOREIGN KEY (thr_id) REFERENCES threads(id);


--
-- Name: messages_txt_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: %%USER%%
--

ALTER TABLE ONLY messages
    ADD CONSTRAINT messages_txt_id_fkey FOREIGN KEY (txt_id) REFERENCES textdata(id);


-- --
-- -- Name: service_parameters_service_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: %%USER%%
-- --

-- ALTER TABLE ONLY service_parameters
--     ADD CONSTRAINT service_parameters_service_id_fkey FOREIGN KEY (service_id) REFERENCES services(id);


--
-- Name: threads_article_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: %%USER%%
--

ALTER TABLE ONLY threads
    ADD CONSTRAINT threads_article_id_fkey FOREIGN KEY (article_id) REFERENCES textdata(id);


--
-- Name: threads_author_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: %%USER%%
--

ALTER TABLE ONLY threads
    ADD CONSTRAINT threads_author_id_fkey FOREIGN KEY (author_id) REFERENCES users(id);


--
-- Name: threads_frm_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: %%USER%%
--

ALTER TABLE ONLY threads
    ADD CONSTRAINT threads_frm_id_fkey FOREIGN KEY (frm_id) REFERENCES forums(id);



--
-- Name: public; Type: ACL; Schema: -; Owner: pgsql
--

REVOKE ALL ON SCHEMA public FROM PUBLIC;
REVOKE ALL ON SCHEMA public FROM postgres;
GRANT ALL ON SCHEMA public TO postgres;
GRANT ALL ON SCHEMA public TO PUBLIC;


--
-- PostgreSQL database dump complete
--

